signup:
  post:
    summary: サインアップ
    description: 新規ユーザを作成
    tags:
      - Auth
    security:
      - apiKey: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              email:
                type: string
                format: email
                description: ユーザのメールアドレス
                example: "user@example.com"
              password:
                type: string
                description: パスワード
                example: "password123"
            required:
              - email
              - password
    responses:
      '200':
        description: サインアップ成功
        content:
          application/json:
            schema:
              type: object
              properties:
                access_token:
                  type: string
                  description: JWTアクセストークン
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                token_type:
                  type: string
                  example: "bearer"
                expires_in:
                  type: integer
                  description: トークンの有効期限（秒）
                  example: 3600
                expires_at:
                  type: integer
                  description: トークンの有効期限（Unix timestamp）
                  example: 1758013496
                refresh_token:
                  type: string
                  description: リフレッシュトークン
                  example: "42c5rljcaysp"
                user:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "019eb980-7b07-4096-a2a4-eedfaa82993f"
                    aud:
                      type: string
                      example: "authenticated"
                    role:
                      type: string
                      example: "authenticated"
                    email:
                      type: string
                      example: "testaaa@example.com"
                    email_confirmed_at:
                      type: string
                      format: date-time
                      example: "2025-09-16T08:04:56.058716255Z"
                    phone:
                      type: string
                      example: ""
                    last_sign_in_at:
                      type: string
                      format: date-time
                      example: "2025-09-16T08:04:56.062900736Z"
                    app_metadata:
                      type: object
                      properties:
                        provider:
                          type: string
                          example: "email"
                        providers:
                          type: array
                          items:
                            type: string
                          example: ["email"]
                    user_metadata:
                      type: object
                      properties:
                        email:
                          type: string
                          example: "test@example.com"
                        email_verified:
                          type: boolean
                          example: true
                        phone_verified:
                          type: boolean
                          example: false
                        sub:
                          type: string
                          example: "019eb980-7b07-4096-a2a4-eedfaa82993f"
                    identities:
                      type: array
                      items:
                        type: object
                        properties:
                          identity_id:
                            type: string
                            example: "3fc64997-3621-4db0-941c-81ff113cb0b3"
                          id:
                            type: string
                            example: "019eb980-7b07-4096-a2a4-eedfaa82993f"
                          user_id:
                            type: string
                            example: "019eb980-7b07-4096-a2a4-eedfaa82993f"
                          provider:
                            type: string
                            example: "email"
                          last_sign_in_at:
                            type: string
                            format: date-time
                            example: "2025-09-16T08:04:56.054454023Z"
                          created_at:
                            type: string
                            format: date-time
                            example: "2025-09-16T08:04:56.054484Z"
                          updated_at:
                            type: string
                            format: date-time
                            example: "2025-09-16T08:04:56.054484Z"
                          email:
                            type: string
                            example: "testaaa@example.com"
                    created_at:
                      type: string
                      format: date-time
                      example: "2025-09-16T08:04:56.032741Z"
                    updated_at:
                      type: string
                      format: date-time
                      example: "2025-09-16T08:04:56.066188Z"
                    is_anonymous:
                      type: boolean
                      example: false
      '422':
        description: サインアップエラー（重複メールアドレスなど）
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 422
                error_code:
                  type: string
                  example: "user_already_exists"
                msg:
                  type: string
                  example: "User already registered"
              required:
                - code
                - error_code
                - msg

signin:
  post:
    summary: サインイン
    description: 既存ユーザでサインイン
    tags:
      - Auth
    security:
      - apiKey: []
    parameters:
      - name: grant_type
        in: query
        required: true
        schema:
          type: string
          enum: [password]
        description: 認証タイプ
        example: "password"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              email:
                type: string
                format: email
                description: ユーザのメールアドレス
                example: "test@example.com"
              password:
                type: string
                description: パスワード
                example: "password123"
            required:
              - email
              - password
    responses:
      '200':
        description: サインイン成功
        content:
          application/json:
            schema:
              type: object
              properties:
                access_token:
                  type: string
                  description: JWTアクセストークン
                  example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                token_type:
                  type: string
                  example: "bearer"
                expires_in:
                  type: integer
                  description: トークンの有効期限（秒）
                  example: 3600
                expires_at:
                  type: integer
                  description: トークンの有効期限（Unix timestamp）
                  example: 1758013872
                refresh_token:
                  type: string
                  description: リフレッシュトークン
                  example: "aoxiuchy5ld4"
                user:
                  type: object
                  properties:
                    id:
                      type: string
                      example: "8cd59145-725b-4eae-9537-b7c29851aa66"
                    aud:
                      type: string
                      example: "authenticated"
                    role:
                      type: string
                      example: "authenticated"
                    email:
                      type: string
                      example: "test@example.com"
                    email_confirmed_at:
                      type: string
                      format: date-time
                      example: "2025-09-10T18:51:23.715763Z"
                    phone:
                      type: string
                      example: ""
                    confirmed_at:
                      type: string
                      format: date-time
                      example: "2025-09-10T18:51:23.715763Z"
                    last_sign_in_at:
                      type: string
                      format: date-time
                      example: "2025-09-16T08:11:12.48347775Z"
                    app_metadata:
                      type: object
                      properties:
                        provider:
                          type: string
                          example: "email"
                        providers:
                          type: array
                          items:
                            type: string
                          example: ["email"]
                    user_metadata:
                      type: object
                      properties:
                        email:
                          type: string
                          example: "test@example.com"
                        email_verified:
                          type: boolean
                          example: true
                        phone_verified:
                          type: boolean
                          example: false
                        sub:
                          type: string
                          example: "8cd59145-725b-4eae-9537-b7c29851aa66"
                    identities:
                      type: array
                      items:
                        type: object
                        properties:
                          identity_id:
                            type: string
                            example: "c7a64d62-07b6-4074-8ffa-356de16905b4"
                          id:
                            type: string
                            example: "8cd59145-725b-4eae-9537-b7c29851aa66"
                          user_id:
                            type: string
                            example: "8cd59145-725b-4eae-9537-b7c29851aa66"
                          provider:
                            type: string
                            example: "email"
                          last_sign_in_at:
                            type: string
                            format: date-time
                            example: "2025-09-10T18:51:23.713492Z"
                          created_at:
                            type: string
                            format: date-time
                            example: "2025-09-10T18:51:23.713515Z"
                          updated_at:
                            type: string
                            format: date-time
                            example: "2025-09-10T18:51:23.713515Z"
                          email:
                            type: string
                            example: "test@example.com"
                    created_at:
                      type: string
                      format: date-time
                      example: "2025-09-10T18:51:23.703962Z"
                    updated_at:
                      type: string
                      format: date-time
                      example: "2025-09-16T08:11:12.486027Z"
                    is_anonymous:
                      type: boolean
                      example: false
                weak_password:
                  type: string
                  nullable: true
                  example: null
      '400':
        description: サインインエラー（認証情報が無効）
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 400
                error_code:
                  type: string
                  example: "invalid_credentials"
                msg:
                  type: string
                  example: "Invalid login credentials"
              required:
                - code
                - error_code
                - msg
